# Analysis Scripts

This directory contains analysis scripts for comparing and evaluating the cleaned biomedical literature datasets (NGD, PubTator, and OmniCorp).

## ğŸ“‹ Available Analyses

### 1. **Identifier Overlap Analysis**
**Script**: `identifier_overlap.py`
**Purpose**: Analyzes overlap patterns of normalized biological entity identifiers across all three datasets
**Output**: `../../analysis_results/identifier_overlap/`

```bash
cd src/analysis
uv run python identifier_overlap.py
```

**Generates**:
- Console summary report with overlap statistics
- `overlap_summary.csv` - Basic overlap counts
- `overlap_by_prefix.csv` - Breakdown by CURIE prefix
- `overlap_by_biolink_type.csv` - Breakdown by biological entity type
- `sample_identifiers_*.txt` - Sample identifiers from each overlap category

### 2. **Drug-Disease Coverage Analysis** 
**Script**: `drug_disease_coverage.py`
**Purpose**: Analyzes coverage of drug-disease pairs from clinical indication and contraindication lists
**Input**: `../../input/medi/Indications List.csv`, `../../input/medi/Contraindications List.csv`
**Output**: `../../analysis_results/drug_disease_coverage/`

```bash
cd src/analysis  
uv run python drug_disease_coverage.py
```

**Generates**:
- Console coverage summary with original vs. renormalized comparisons
- `indications_coverage_analysis.csv` - Full indication pairs with coverage columns
- `contraindications_coverage_analysis.csv` - Full contraindication pairs with coverage columns  
- `unique_drugs_coverage.csv` - Individual drug coverage across datasets
- `unique_diseases_coverage.csv` - Individual disease coverage across datasets

### 3. **Failed Normalization Analysis**
**Script**: `failed_normalizations.py`  
**Purpose**: Analyzes patterns in CURIEs that failed to normalize during dataset cleaning
**Output**: `../../analysis_results/failed_normalizations/`

```bash
cd src/analysis
uv run python failed_normalizations.py
```

**Generates**:
- Console summary report of failures by prefix and dataset
- `failed_normalizations_by_prefix.csv` - Detailed breakdown

### 4. **Normalization Insights**
**Script**: `insights.py`
**Purpose**: Provides key insights and actionable recommendations from failed normalization analysis

```bash
cd src/analysis
uv run python insights.py
```

## ğŸ”§ Prerequisites

Before running analysis scripts, ensure you have:

1. **Cleaned datasets** in `../../cleaned/`
2. **Identifier extracts** generated by running:
   ```bash
   uv run python ../extract_identifiers.py
   ```
3. **Input files** for drug-disease analysis in project root

## ğŸ“Š Output Structure

```
analysis_results/
â”œâ”€â”€ identifier_overlap/         # Cross-dataset overlap analysis
â”œâ”€â”€ drug_disease_coverage/      # Clinical pairs coverage analysis  
â”œâ”€â”€ failed_normalizations/      # Normalization failure analysis
â””â”€â”€ raw_data_extracts/         # Pickle files with extracted identifiers
```

## ğŸš€ Quick Start

Run all analyses in sequence:

```bash
# 1. Extract identifiers (run once from project root)
uv run python src/extract_identifiers.py

# 2. Run analyses (from src/analysis/ directory)
cd src/analysis
uv run python identifier_overlap.py
uv run python drug_disease_coverage.py  
uv run python failed_normalizations.py
uv run python insights.py
```

## ğŸ“ Notes

- All scripts use relative paths and must be run from `src/analysis/` directory
- Scripts automatically create output directories as needed
- Analysis results are saved to `../../analysis_results/` to keep them organized and separate from source code
- The drug-disease coverage analysis includes both original and API-renormalized identifier comparisons